<html>
  <head>
    <title>Hello world</title>

     <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
     <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
     <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
  </head>

  <body>

    <div id="map" style="height:600px; width:600px;"></div>

  </body>

    <script type="text/javascript">
        // Initialize map
        var map = L.map('map').setView([38.9483, -92.333], 12);
 
        // Load tiles
        var mapquestLayer = new L.TileLayer('http://{s}.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.png', {      maxZoom: 18,
            attribution: 'Data, imagery and map information provided by <a href="http://open.mapquest.co.uk" target="_blank">MapQuest</a>,<a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> and contributors.',            
            subdomains: ['otile1','otile2','otile3','otile4']
        });
        map.addLayer(mapquestLayer);
 
        $.ajax({
            url: 'http://127.0.0.1:5000/incidents.json', // The URL of the datafile you want to load. In this case, could also be written as 127.0.0.1:8000/incidents.json
            // This "success" argument is a function that executes once the data loads, known as a callback. The function automatically
            // receives the data once it's loaded via the "data" argument. The data can then be manipulated inside the function.
            success: function(data) {
                // Javascript for loop syntax
                for (i=0; i < data.length; i++){
                    // Check to see whether the record has both an X and Y coordinate
                    if (data[i].XCoord && data[i].YCoord) {
                        // If it does, plot it on the map, using the syntax we discussed before
                        L.marker([data[i].YCoord, data[i].XCoord])
                            .addTo(map)
                            .bindPopup(data[i].ExtNatureDisplayName);
                    }
                } // Close the for loop
            } // Close the success function
        }); // Close the ajax method call
    </script>

</html>
